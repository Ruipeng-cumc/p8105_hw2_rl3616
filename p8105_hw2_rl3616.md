p8105_hw2_rl3616
================
Ruipeng Li
2025-10-01

Loading packages.

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.2
    ## ✔ ggplot2   4.0.0     ✔ tibble    3.3.0
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
    ## ✔ purrr     1.1.0     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(lubridate)      #to use parse_date_time
```

# Problem 1

#### Part 1

Clean the data in pols-month.csv.

``` r
pols_df <- read_csv("data/pols-month.csv") |>
  janitor::clean_names() |>
  separate(mon, into = c("year", "month", "day"), convert = TRUE) |>
  mutate(
    month = month.name[month],
    president = ifelse(prez_gop == 1, "gop", "dem")
    ) |>
  select(-prez_gop, -prez_dem, -day) |> 
  arrange(year, factor(month, levels = tolower(month.name)))   #Old data to new data
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Finished part one, let’s looking at our new pols-month.

``` r
pols_df
```

    ## # A tibble: 822 × 9
    ##     year month     gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president
    ##    <int> <chr>       <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>    
    ##  1  1947 January        23      51     253      23      45     198 dem      
    ##  2  1947 February       23      51     253      23      45     198 dem      
    ##  3  1947 March          23      51     253      23      45     198 dem      
    ##  4  1947 April          23      51     253      23      45     198 dem      
    ##  5  1947 May            23      51     253      23      45     198 dem      
    ##  6  1947 June           23      51     253      23      45     198 dem      
    ##  7  1947 July           23      51     253      23      45     198 dem      
    ##  8  1947 August         23      51     253      23      45     198 dem      
    ##  9  1947 September      23      51     253      23      45     198 dem      
    ## 10  1947 October        23      51     253      23      45     198 dem      
    ## # ℹ 812 more rows

#### Part 2

clean the data in snp.csv This is pretty complicate since we both have
yyyy/m/d type of date and m/d/yy

``` r
snp_df <- read_csv("data/snp.csv") |>
  janitor::clean_names() |>
  mutate(date = parse_date_time(date, orders = c("ymd", "mdy"))) |>     
  separate(date, into = c("year", "month", "day"), convert = TRUE) |>
  mutate(
    year  = if_else(year > 2015, year - 100L, year),
    month = month.name[month]
    ) |> 
  select(-day) |> 
  arrange(year, factor(month, levels = tolower(month.name)))   #Old data to new data
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

I found “parse_date_time()” in lubridate package can both help me clean
the “ymd” and “mdy” into “y-m-d” type, and arrange and organize the
data, I don’t know is that always happens? but I’m feeling complicate in
using “skip” and something more like part one.

``` r
snp_df
```

    ## # A tibble: 787 × 3
    ##     year month     close
    ##    <int> <chr>     <dbl>
    ##  1  1950 December   20.4
    ##  2  1950 November   19.5
    ##  3  1950 October    19.5
    ##  4  1950 September  19.5
    ##  5  1950 August     18.4
    ##  6  1950 July       17.8
    ##  7  1950 June       17.7
    ##  8  1950 May        18.8
    ##  9  1950 April      18.0
    ## 10  1950 March      17.3
    ## # ℹ 777 more rows

#### Part 3

clean the data in unemployment.csv

``` r
unemp_df <- read_csv("data/unemployment.csv") |>
  janitor::clean_names() |>
  pivot_longer(
    cols = jan:dec,                 
    names_to = "month",
    values_to = "unemployment"
  ) |>
  mutate(
    month = month.name[match(month, tolower(month.abb))]       #Use tolower() to match the month in lowercase.
  ) |>
  select(year, month, unemployment) |>
  arrange(year, factor(month, levels = tolower(month.name)))   #Old data to new data
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
unemp_df
```

    ## # A tibble: 816 × 3
    ##     year month     unemployment
    ##    <dbl> <chr>            <dbl>
    ##  1  1948 January            3.4
    ##  2  1948 February           3.8
    ##  3  1948 March              4  
    ##  4  1948 April              3.9
    ##  5  1948 May                3.5
    ##  6  1948 June               3.6
    ##  7  1948 July               3.6
    ##  8  1948 August             3.9
    ##  9  1948 September          3.8
    ## 10  1948 October            3.7
    ## # ℹ 806 more rows

#### Combaining all together

``` r
final_df <- pols_df |>
  left_join(snp_df, by = c("year","month")) |>
  left_join(unemp_df, by = c("year","month"))


knitr::kable(head(final_df, 20))      #Just checking our data.
```

| year | month | gov_gop | sen_gop | rep_gop | gov_dem | sen_dem | rep_dem | president | close | unemployment |
|---:|:---|---:|---:|---:|---:|---:|---:|:---|---:|---:|
| 1947 | January | 23 | 51 | 253 | 23 | 45 | 198 | dem | NA | NA |
| 1947 | February | 23 | 51 | 253 | 23 | 45 | 198 | dem | NA | NA |
| 1947 | March | 23 | 51 | 253 | 23 | 45 | 198 | dem | NA | NA |
| 1947 | April | 23 | 51 | 253 | 23 | 45 | 198 | dem | NA | NA |
| 1947 | May | 23 | 51 | 253 | 23 | 45 | 198 | dem | NA | NA |
| 1947 | June | 23 | 51 | 253 | 23 | 45 | 198 | dem | NA | NA |
| 1947 | July | 23 | 51 | 253 | 23 | 45 | 198 | dem | NA | NA |
| 1947 | August | 23 | 51 | 253 | 23 | 45 | 198 | dem | NA | NA |
| 1947 | September | 23 | 51 | 253 | 23 | 45 | 198 | dem | NA | NA |
| 1947 | October | 23 | 51 | 253 | 23 | 45 | 198 | dem | NA | NA |
| 1947 | November | 24 | 51 | 253 | 23 | 45 | 198 | dem | NA | NA |
| 1947 | December | 24 | 51 | 253 | 23 | 45 | 198 | dem | NA | NA |
| 1948 | January | 22 | 53 | 253 | 24 | 48 | 198 | dem | NA | 3.4 |
| 1948 | February | 22 | 53 | 253 | 24 | 48 | 198 | dem | NA | 3.8 |
| 1948 | March | 22 | 53 | 253 | 24 | 48 | 198 | dem | NA | 4.0 |
| 1948 | April | 22 | 53 | 253 | 24 | 48 | 198 | dem | NA | 3.9 |
| 1948 | May | 22 | 53 | 253 | 24 | 48 | 198 | dem | NA | 3.5 |
| 1948 | June | 22 | 53 | 253 | 24 | 48 | 198 | dem | NA | 3.6 |
| 1948 | July | 22 | 53 | 253 | 24 | 48 | 198 | dem | NA | 3.6 |
| 1948 | August | 22 | 53 | 253 | 24 | 48 | 198 | dem | NA | 3.9 |

``` r
final_df <- final_df |>
  arrange(desc(year), desc(month))

knitr::kable(head(final_df, 20))      #Checking from new to old data.
```

| year | month | gov_gop | sen_gop | rep_gop | gov_dem | sen_dem | rep_dem | president | close | unemployment |
|---:|:---|---:|---:|---:|---:|---:|---:|:---|---:|---:|
| 2015 | May | 31 | 54 | 245 | 18 | 44 | 188 | dem | 2107.39 | 5.5 |
| 2015 | March | 31 | 54 | 245 | 18 | 44 | 188 | dem | 2067.89 | 5.5 |
| 2015 | June | 31 | 54 | 246 | 18 | 44 | 188 | dem | 2063.11 | 5.3 |
| 2015 | January | 31 | 54 | 245 | 18 | 44 | 188 | dem | 1994.99 | 5.7 |
| 2015 | February | 31 | 54 | 245 | 18 | 44 | 188 | dem | 2104.50 | 5.5 |
| 2015 | April | 31 | 54 | 244 | 18 | 44 | 188 | dem | 2085.51 | 5.4 |
| 2014 | September | 29 | 45 | 234 | 21 | 53 | 199 | dem | 1972.29 | 5.9 |
| 2014 | October | 29 | 45 | 234 | 21 | 53 | 199 | dem | 2018.05 | 5.7 |
| 2014 | November | 29 | 45 | 235 | 21 | 53 | 201 | dem | 2067.56 | 5.8 |
| 2014 | May | 29 | 45 | 233 | 21 | 53 | 199 | dem | 1923.57 | 6.3 |
| 2014 | March | 29 | 45 | 233 | 21 | 53 | 199 | dem | 1872.34 | 6.6 |
| 2014 | June | 29 | 45 | 233 | 21 | 53 | 199 | dem | 1960.23 | 6.1 |
| 2014 | July | 29 | 45 | 234 | 21 | 53 | 199 | dem | 1930.67 | 6.2 |
| 2014 | January | 29 | 45 | 232 | 21 | 53 | 200 | dem | 1782.59 | 6.6 |
| 2014 | February | 29 | 45 | 232 | 21 | 53 | 200 | dem | 1859.45 | 6.7 |
| 2014 | December | 29 | 45 | 235 | 21 | 53 | 201 | dem | 2058.90 | 5.6 |
| 2014 | August | 29 | 45 | 234 | 21 | 53 | 199 | dem | 2003.37 | 6.1 |
| 2014 | April | 29 | 45 | 233 | 21 | 53 | 199 | dem | 1883.95 | 6.2 |
| 2013 | September | 30 | 46 | 234 | 20 | 53 | 201 | dem | 1681.55 | 7.2 |
| 2013 | October | 30 | 46 | 234 | 20 | 53 | 201 | dem | 1756.54 | 7.2 |

#### Conclusion

The `pols-month` table records the number of governors, senators, and
representatives from each party during the presidential elections of
different parties (Democratic/Republican).

The `snp` table represents stock market trends, and the `close` value
reflects the overall stock price level of large companies.

The `unemployment` table represents the US unemployment rate.

We merged and then split the year and month data into the `final_df`
table. This allows us to compare presidential party, stock market
performance, and unemployment rates for a specific year and month,
making it ideal for studying the relationship between politics, the
economy, and employment.

The dataset spans 1947–2015 and covers many important historical events,
such as the 1973–1975 oil crisis, the 1981–1982 recession, the 2000
dot-com bubble, and the 2007–2009 Great Recession. Therefore, this
dataset provides significant reference value for studying the
relationships between politics, the economy, and employment.
